<!DOCTYPE html>
<html>

<head>
  <title>Results</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/loader.css" />
  <link rel="stylesheet" type="text/css" href="stylesheets/table.css" />
  <link rel="stylesheet" type="text/css" href="stylesheets/upload.css" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="javascripts/chunkList.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
    integrity="sha256-t9UJPrESBeG2ojKTIcFLPGF7nHi2vEc7f5A2KpH/UBU=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
  <link rel="stylesheet" type="text/css" src="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
</head>

<body>

  <h1>Results</h1>
     <div class="container">
      <form id="form" >
        <div class="input-group">
         

          <% if (contents) { %>
            <div style="width: fit-content;">
              <span style="display:inline;">
                <script>
                  const occurrenceString = "<%= contents['occurrenceList'] %>";
                  const occurrenceList = occurrenceString.split(',');
                  $('#document').ready(() => {
        
                    $('#myDynamicTable').DataTable({
                      "scrollY": "200px",
                      "searching": true,
                      "scrollCollapse": true,
                      language: {
                        url: 'http://cdn.datatables.net/plug-ins/1.10.24/i18n/Arabic.json',
                      },
                      aoColumns: [{ bSearchable: true, bSortable: false }],
                    });
                    addTable(occurrenceList.chunk(2));
                    $('.dataTables_length').addClass('bs-select');
                   
                  });
                </script>
        </div>
      </form>
    </div>
        <table id="myDynamicTable"></table>
      </span>
      <span style="display:inline;">
        sads
      </span>

    </div>

    <div id="wordCount" style="font-size: large; display: block; text-align: center;">
      Total Word Count: <%= contents['wordCount'] %>
    </div>
    <div id="uniqueWordCount" style="font-size: large; display: block; text-align: center;">
      Unique Word Count: <%= contents['uniqueWordCount'] %>
    </div>

    <canvas id="myChart"></canvas>

    </div>
    <% } %>


    <script>

function getCol(matrix, col){
       var column = [];
       for(var i=0; i<matrix.length; i++){
          column.push(matrix[i][col]);
       }
       return column;
    }

      var ctx = document.getElementById('myChart').getContext('2d');
var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'bar',

    // The data for our dataset
    data: {
        labels: getCol(occurrenceList.chunk(2), 0),
        datasets: [{
            label: 'تردد الكلمات',
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: getCol(occurrenceList.chunk(2), 1)
        }]
    },

    // Configuration options go here
    options: {}
});
    </script>

      <script src="javascripts/buildTable.js"></script>

      <div class="loader-wrapper">
        <span class="loader"><span class="loader-inner"></span></span>
      </div>

      <script>
        $(window).on("load", function () {
          $(".loader-wrapper").fadeOut("fast");
        });
      </script>


</body>

</html>